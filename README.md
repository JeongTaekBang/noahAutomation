# NOAH 발주서 자동 생성기

RCK Order No.를 입력하면 NOAH Factory용 발주서(Purchase Order)를 자동으로 생성합니다.

---

## 사용 방법

### 1단계: 주문 정보 입력

`NOAH_PO_Lists.xlsx` 파일에 주문 정보를 입력합니다.

| 시트 | 용도 |
|------|------|
| 국내 | 국내 고객 주문 |
| 해외 | 해외 고객 주문 |

**필수 입력 항목:**
- `RCK Order no.` - 주문번호 (예: ND-0001, NO-0001)
- `Customer name` - 고객명
- `Customer PO` - 고객 발주번호
- `Item qty` - 수량
- `Model` - 모델명
- `ICO Unit` - 단가

### 2단계: 발주서 생성

`create_po.bat` 파일을 더블클릭하고 주문번호를 입력합니다.

```
==============================
 NOAH 발주서 생성기
==============================
RCK Order No.를 입력하세요: ND-0001
```

또는 명령 프롬프트에서 직접 실행:

```bash
# 단일 발주
python create_po.py ND-0001

# 여러 건 동시 생성
python create_po.py ND-0001 ND-0002 ND-0003
```

### 3단계: 결과 확인

생성된 발주서는 `generated_po` 폴더에 저장됩니다.

```
generated_po/
  └── PO_ND-0001_고객명_260111.xlsx
```

파일에는 2개의 시트가 포함됩니다:
- **Purchase Order** - 발주서 본문
- **Description** - 액추에이터 사양 상세

---

## 자동 검증 항목

발주서 생성 시 다음 항목을 자동으로 검증합니다:

| 검증 항목 | 조건 | 결과 |
|----------|------|------|
| 필수 필드 | 비어있음 | 오류 |
| ICO Unit | 0 또는 음수 | 오류 |
| 납기일 | 과거 날짜 | 오류 |
| 납기일 | 7일 이내 | 경고 |
| 중복 발주 | 이미 생성된 주문번호 | 경고 (확인 후 진행 가능) |

오류가 있으면 진행 여부를 확인합니다. 강제로 생성하려면:

```bash
python create_po.py ND-0001 --force
```

---

## 파일 구조

```
purchaseOrderAutomation/
├── NOAH_PO_Lists.xlsx   ← 여기에 주문 정보 입력
├── create_po.bat        ← 더블클릭으로 실행
├── create_po.py         ← 메인 프로그램
├── generated_po/        ← 생성된 발주서 저장 폴더
└── po_history.xlsx      ← 발주 이력 (자동 생성)
```

---

## 다중 아이템 주문

동일한 `RCK Order no.`로 여러 행을 입력하면 하나의 발주서에 여러 아이템이 포함됩니다.

**NOAH_PO_Lists.xlsx 예시:**

| RCK Order no. | Customer name | Item name | Item qty | ICO Unit |
|---------------|---------------|-----------|----------|----------|
| ND-0001 | ABC전자 | NA-100 | 2 | 500,000 |
| ND-0001 | ABC전자 | NA-200 | 1 | 750,000 |

→ `ND-0001` 발주서에 2개 아이템이 포함됨

---

## 문제 해결

### "주문번호를 찾을 수 없습니다"
- `NOAH_PO_Lists.xlsx`에 해당 주문번호가 있는지 확인
- 주문번호 앞뒤 공백 확인
- 국내/해외 시트 모두 확인

### "ICO Unit이 0입니다"
- 단가가 입력되었는지 확인
- 숫자 형식인지 확인 (텍스트로 입력되면 인식 안 됨)

### "이미 발주된 건입니다"
- `po_history.xlsx`에서 이전 발주 기록 확인
- 재발주가 필요하면 Y 입력하여 진행

---

## 문의

문제가 있으면 담당자에게 문의하세요.
